(function r(n,e,t){function i(a,o){if(!e[a]){if(!n[a]){var l=typeof require=="function"&&require;if(!o&&l)return l(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var s=e[a]={exports:{}};n[a][0].call(s.exports,function(r){var e=n[a][1][r];return i(e?e:r)},s,s.exports,r,n,e,t)}return e[a].exports}var u=typeof require=="function"&&require;for(var a=0;a<t.length;a++)i(t[a]);return i})({1:[function(r,n,e){var t,i,u,a,o,l,f,e,s,c,p,m,N;f=r("underscore");f.str=r("underscore.string");f.mixin(f.str.exports());m=r("object-inspect");l=r("./utils");N=l.toArray;u={locale:"en_US",language:"en-US",country:"US",currencyCode:"USD",currencySymbol:"$",timeZone:"UTC",decimalSeparator:".",groupingSeparator:",",groupingSize:3};i=f.extend({},u);e={};e.NO_VALUE=void 0;e.MATH_FUNC=o=function(r){return function(){return r.apply(Math,N(arguments).map(NUM))}};e.ABS=o(Math.abs);e.ACOS=o(Math.acos);e.ACOSH=function(r){r=NUM(r);return Math.log(r+Math.sqrt(r*r-1))};e.AND=function(){return f.find(N(arguments),function(r){return!r})===void 0};e.APPLICATION=function(){var r;return(r=i.application)!=null?r:""};e.APPLICATIONBUILD=function(){var r;return(r=i.applicationBuild)!=null?r:""};e.APPLICATIONINFO=function(r){if(r==null){r=", "}return f.compact([APPLICATION(),APPLICATIONVERSION(),APPLICATIONBUILD()]).join(r)};e.APPLICATIONVERSION=function(){var r;return(r=i.applicationVersion)!=null?r:""};e.AVERAGE=function(){var r;r=N(arguments);if(r.length===0){return NaN}return f.inject(r,function(r,n){return r+ +n},0)/r.length};e.CEILING=function(r,n){var e;if(n==null){n=1}if(n==null){n=1}n=ABS(n);r=NUM(r);if(isNaN(r)||isNaN(n)){return NaN}if(n===0){return 0}e=PRECISION(n);if(r>=0){return ROUND(Math.ceil(r/n)*n,e)}else{return-ROUND(Math.floor(Math.abs(r)/n)*n,e)}};e.CHAR=function(r){r=NUM(r);return String.fromCharCode(r)};e.CHOICEVALUE=function(r){var n;n=CHOICEVALUES(r);if(!f.isArray(n)){return NO_VALUE}if(n.length===0){return NO_VALUE}return n[0]};e.CHOICEVALUES=function(r){var n;if(!((r!=null?r.choice_values:void 0)!=null||(r!=null?r.other_values:void 0)!=null)){return NO_VALUE}if(ISBLANK(r)){return[]}n=[].concat(r.choice_values).concat(r.other_values);return f.compact(n)};t=/[\x00\x08\x0B\x0C\x0E-\x1F]/g;e.CLEAN=function(r){if(r==null){r=""}return r.replace(t,"")};e.COALESCE=function(){var r;if(arguments.length===1&&f.isArray(arguments[0])){return COALESCE.apply(null,arguments[0])}else{return(r=f.find(N(arguments),function(r){return r!=null}))!=null?r:NO_VALUE}};e.CODE=function(r){if(f.isNumber(r)){r=r.toString()}if(!f.isString(r)){return NaN}return(r!=null?r:"").charCodeAt(0)};e.COMPACT=function(r){if(!f.isArray(r)){return void 0}return f.filter(r,function(r){return r!=null})};e.CONCATENATE=function(){var r;r=f.map(N(arguments),function(r){switch(true){case f.isString(r):return r;case f.isNumber(r):return""+r;default:return""}});return r.join("")};e.CONFIG=function(){return i};e.CONFIGURE=function(r,n){if(n==null){n=true}if(n){f.extend(i,r)}else{i=r}return i};e.COS=o(Math.cos);e.COSH=function(r){var n;r=NUM(r);n=Math.exp(r);return(n+1/n)/2};e.COUNT=function(r){var n;if(!f.isArray(r)){return NO_VALUE}n=f.select(COMPACT(r).map(NUM),function(r){return!isNaN(r)});return n.length};e.COUNTA=function(r){if(!f.isArray(r)){return NO_VALUE}return r.length};e.COUNTBLANK=function(r){var n;if(!f.isArray(r)){return NaN}n=f.filter(r,function(r){switch(true){case r==null:return true;case f.isArray(r):return r.length===0;case f.isString(r):return f.isBlank(r);default:return false}});return n.length};e.COUNTRY=function(){return i.country||u.country};e.CURRENCYCODE=function(){return i.currencyCode||u.currencyCode};e.CURRENCYSYMBOL=function(){return i.currencySymbol||u.currencySymbol};e.DATE=function(r,n,e){r=INT(r);n=INT(n);e=INT(e);if(isNaN(r)||isNaN(n)||isNaN(e)){return NO_VALUE}return new Date(r+"/"+n+"/"+e+" 00:00:00")};e.DATEADD=function(r,n,e){var t;if(e==null){e="day"}r=DATEVALUE(r);n=INT(n);if(r==null){return NO_VALUE}if(isNaN(n)){return NO_VALUE}if(e!=="day"){return NO_VALUE}t=r.getTime();t+=n*(1e3*60*60*24);return new Date(t)};e.DATEVALUE=function(r){var n;if(f.isDate(r)){return r}if(f.isString(r)&&r.length<=10){r=r.replace(/-/g,"/")}n=new Date(r);if(isNaN(n.getTime())){return NO_VALUE}return n};e.DAY=function(r){r=DATEVALUE(r);if(r==null){return NO_VALUE}return r.getDate()};e.DECIMALSEPARATOR=function(){return i.decimalSeparator||u.decimalSeparator};e.DEGREES=function(r){r=NUM(r);if(!f.isNumber(r)){return NaN}return 180*r/Math.PI};e.DEVICEINFO=function(r){if(r==null){r=", "}return f.compact([DEVICEMANUFACTURER(),DEVICEMODEL()]).join(r)};e.DEVICEMODEL=function(){var r;return(r=i.deviceModel)!=null?r:""};e.DEVICEMANUFACTURER=function(){var r;return(r=i.deviceManufacturer)!=null?r:""};e.DOLLAR=function(r,n,e,t){var i;if(n==null){n=2}if(e==null){e=null}if(t==null){t=null}n=NUM(n);if(n==null){n=2}if(isNaN(n)){n=2}r=NUM(r);if(!f.isNumber(r)){return NO_VALUE}if(e==null){e=CURRENCYCODE()}if(t==null){t=LANGUAGE()}i={style:"currency",currency:e,minimumFractionDigits:n,maximumFractionDigits:n};return FORMATNUMBER(r,t,i)};e.EMAIL=function(){var r;return(r=CONFIG().userEmail)!=null?r:NO_VALUE};e.EVEN=function(r){r=NUM(r);if(!f.isNumber(r)){return NaN}return CEILING(r,-2,-1)};e.EXACT=function(r,n){return f.isEqual(r,n)};e.EXP=o(Math.exp);e.MEMOIZED_FACT=[];e.FACT=function(r){var n;r=NUM(r);if(isNaN(r)){return NaN}if(r<0){return NaN}n=Math.floor(r);if(n===0||n===1){return 1}else if(MEMOIZED_FACT[n]>0){return MEMOIZED_FACT[n]}else{MEMOIZED_FACT[n]=FACT(n-1)*n;return MEMOIZED_FACT[n]}};e.MEMOIZED_FACTDOUBLE=[];e.FACTDOUBLE=function(r){var n;r=NUM(r);if(isNaN(r)){return NaN}if(r<0){return NaN}n=Math.floor(r);if(n<=1){return 1}else if(MEMOIZED_FACTDOUBLE[n]>0){return MEMOIZED_FACTDOUBLE[n]}else{MEMOIZED_FACTDOUBLE[n]=FACTDOUBLE(n-2)*n;return MEMOIZED_FACTDOUBLE[n]}};e.FALSE=function(){return false};e.FIND=function(r,n,e){var t;e=NUM(e);if(isNaN(e)){e=0}if(!(n&&n.indexOf)){return NO_VALUE}if(f.isArray(r)){return NO_VALUE}t=n.indexOf(r,e-1);if(t<0){return NO_VALUE}return t+1};e.FIXED=function(r,n,e){var t,i,u,a,o,l,f,s,c,p,m,N,h,g;if(n==null){n=2}if(e==null){e=false}r=NUM(r);n=NUM(n);if(isNaN(n)){n=2}n=MAX(n,0);n=MIN(n,20);if(isNaN(r)){return NO_VALUE}if(isNaN(n)){return NO_VALUE}e=!!e;m=Math.pow(10,n);N=parseInt(r*m);s=".";c=r.toFixed(n);o=c.indexOf(s);if(!(o>-1)){return c}l=parseInt(c.substring(0,o));t=c.substring(o+1,c.length);f="";a=GROUPINGSIZE();i=Math.pow(10,a);if(e||l<i){f=l.toString()}else{u=GROUPINGSEPARATOR();p=[];while(l>=i){h=Math.floor(l%i);g=new Array(a+1).join("0");p.push(RIGHT(g+h.toString(),a));l=Math.floor(l/i)}if(l>0){p.push(l.toString())}f=p.reverse().join(u)}if(n<1){return f}else{return f+DECIMALSEPARATOR()+t.toString()}};e.FLOOR=function(r,n){var e;if(n==null){n=1}n=ABS(n);r=NUM(r);if(isNaN(r)||isNaN(n)){return NaN}if(n===0){return 0}e=PRECISION(n);if(r>=0){return ROUND(Math.floor(r/n)*n,e)}else{return-ROUND(Math.ceil(Math.abs(r)/n)*n,e)}};e.FORMATNUMBER=function(r,n,e){var t,i;if(r==null){r=NUM(r)}if(n==null){n=LANGUAGE()}if(e==null){e={}}i="decimal";if(e.style==="currency"){i="currency"}if(e.style==="percent"){i="percent"}e.style=i;if(e.style==="currency"){if(e.currency==null){e.currency=CURRENCYCODE()}}t=f.isNumber(e.minimumSignificantDigits)||f.isNumber(e.maximumSignificantDigits);if(t){if(e.minimumSignificantDigits==null){e.minimumSignificantDigits=1}e.minimumSignificantDigits=NUM(e.minimumSignificantDigits);e.minimumSignificantDigits=MIN(MAX(e.minimumSignificantDigits,1),21);if(e.maximumSignificantDigits==null){e.maximumSignificantDigits=e.minimumSignificantDigits}e.maximumSignificantDigits=NUM(e.maximumSignificantDigits);e.maximumSignificantDigits=MIN(MAX(e.maximumSignificantDigits,1),21)}else{if(e.minimumIntegerDigits==null){e.minimumIntegerDigits=1}e.minimumIntegerDigits=NUM(e.minimumIntegerDigits);e.minimumIntegerDigits=MIN(MAX(e.minimumIntegerDigits,1),21);if(e.minimumFractionDigits==null){e.minimumFractionDigits=e.style==="currency"?2:0}e.minimumFractionDigits=NUM(e.minimumFractionDigits);e.minimumFractionDigits=MIN(MAX(e.minimumFractionDigits,0),20);if(e.style==="currency"){if(e.maximumFractionDigits==null){e.maximumFractionDigits=2}}else if(e.style==="percent"){if(e.maximumFractionDigits==null){e.maximumFractionDigits=MAX(e.minimumFractionDigits,0)}}else{if(e.maximumFractionDigits==null){e.maximumFractionDigits=MAX(e.minimumFractionDigits,3)}}e.maximumFractionDigits=NUM(e.maximumFractionDigits);e.maximumFractionDigits=MIN(MAX(e.maximumFractionDigits,0),20)}if(!f.isBoolean(e.useGrouping)){e.useGrouping=true}return a.formatNumber(r,n,e)};e.GCD=function(){var r,n,e,t,i,u,a;i=N(arguments).map(NUM);r=i.length;if(i.length===0){return NaN}if(i[0]<0){return NaN}a=i[0];for(n=e=1,u=r-1;1<=u?e<=u:e>=u;n=1<=u?++e:--e){if(i[n]<0){return NaN}t=i[n];while(a&&t){if(a>t){a%=t}else{t%=a}}a+=t}return a};e.GETRESULT=function(){return $$runtime.$$result};e.GROUPINGSEPARATOR=function(){return i.groupingSeparator||u.groupingSeparator};e.GROUPINGSIZE=function(){return i.groupingSize||u.groupingSize};e.HASOTHER=function(r){return!!(r&&r.other_values&&f.isArray(r.other_values)&&r.other_values.length>0)};e.IF=function(r,n,e){if(r){return n}else{return e}};e.IFERROR=function(r,n){if(ISERR(r)){return n}else{return r}};e.INSPECT=function(r){return m(r)};e.INT=e.FLOOR;e.ISBLANK=function(r){var n,e,t,i,u;if(r==null){return true}if(f.isNaN(r)){return true}if(f.isBoolean(r)){return false}if(f.isNumber(r)){return false}if(f.isDate(r)){return false}if(f.isString(r)){return f.isBlank(r)}if(f.isArray(r)){return r.length===0}if(r&&(r.choice_values||r.choice_values===null||r.other_values||r.other_values===null)){n=r.choice_values;u=r.other_values;e=f.isArray(n)&&n.length>0;i=f.isArray(u)&&u.length>0;t=e||i;return!t}return Object.keys(r).length===0};e.ISERR=function(r){if(r==null){return true}if(isNaN(r)){return true}if(r instanceof Error){return true}return false};e.ISERROR=function(r){return ISERR(r)};e.ISLOGICAL=function(r){return f.isBoolean(r)};e.ISNAN=function(r){return f.isNaN(NUM(r))};e.ISEVEN=function(r){r=NUM(r);if(!f.isNumber(r)){return false}if(isNaN(r)){return false}return(Math.floor(Math.abs(r))&1)===0};e.ISNONTEXT=function(r){return!f.isString(r)};e.ISNUMBER=function(r){return f.isNumber(r)};e.ISODD=function(r){r=NUM(r);if(!f.isNumber(r)){return false}if(isNaN(r)){return false}return(Math.floor(Math.abs(r))&1)===1};e.ISSELECTED=function(r,n){if(ISBLANK(r)){return false}if(n==null){return false}if(f.isArray(n)){return n.filter(function(n){return!ISSELECTED(r,n)}).length===0}if(r&&r.choice_values){if(f.contains(r.choice_values,n)){return true}}if(r&&r.other_values){if(f.contains(r.other_values,n)){return true}}return false};e.ISTEXT=function(r){return f.isString(r)};e.LANGUAGE=function(){return i.language||u.language};e.LATITUDE=function(){var r;return NUM((r=CONFIG().featureGeometry)!=null?r.coordinates[1]:void 0)};e.LCM=function(){var r,n,e,t,i,u,a,o;a=N(arguments).map(function(r){return INT(r)});t=a.length;r=Math.abs(a[0]);for(i=u=1,o=t-1;u<=o;i=u+=1){n=Math.abs(a[i]);e=r;if(isNaN(n)){return NaN}while(r&&n){if(r>n){r%=n}else{n%=r}}r=Math.abs(e*a[i])/(r+n)}return r};e.LEFT=function(r,n){if(n==null){n=1}if(n==null){n=1}n=FLOOR(n);if(r==null){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}if(n<0){return NO_VALUE}if(isNaN(n)){return NO_VALUE}r=r.toString();return r.substring(0,n)};e.LEN=function(r){if(r==null){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}return r.toString().length};e.LN=o(Math.log);e.LOCALE=function(){return i.locale||u.locale};e.LOG=function(r,n){r=NUM(r);n=NUM(n!=null?n:10);if(n==null){return NaN}if(isNaN(n)){return NaN}return Math.log(r)/Math.log(n)};e.LOG10=function(r){return LOG(r,10)};e.LONGITUDE=function(){var r;return NUM((r=CONFIG().featureGeometry)!=null?r.coordinates[0]:void 0)};e.LOWER=function(r){if(r==null){return NO_VALUE}if(f.isArray(r)){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}return r.toString().toLowerCase()};e.MAX=function(){var r,n;n=f.flatten(N(arguments));n=f.map(n,NUM);if(n.length===0){return NO_VALUE}r=f.some(n,isNaN);if(r){return NO_VALUE}return Math.max.apply(Math,n)};e.MAXA=function(){if(arguments.length<1){return NO_VALUE}if(!f.isArray(arguments[0])){return NO_VALUE}return MAX.apply(null,arguments[0])};e.MEDIAN=function(){var r,n,e;e=f.flatten(N(arguments));e=f.map(e,NUM);if(!f.isArray(e)){return NO_VALUE}if(e.length===0){return NO_VALUE}n=f.some(e,isNaN);if(n){return NO_VALUE}e.sort(function(r,n){return r-n});r=Math.floor(e.length/2);if(e.length%2){return e[r]}else{return(e[r-1]+e[r])/2}};e.MID=function(r,n,e){n=FLOOR(n);e=FLOOR(e);if(r==null){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}if(n<1){return NO_VALUE}if(isNaN(n)){return NO_VALUE}if(e<0){return NO_VALUE}if(isNaN(e)){return NO_VALUE}r=r.toString();return r.substr(n-1,e)};e.MIN=function(){var r,n;n=f.flatten(N(arguments));n=f.map(n,NUM);if(n.length===0){return NO_VALUE}r=f.some(n,isNaN);if(r){return NO_VALUE}return Math.min.apply(Math,n)};e.MINA=function(){if(arguments.length<1){return NO_VALUE}if(!f.isArray(arguments[0])){return NO_VALUE}return MIN.apply(null,arguments[0])};e.MOD=function(r,n){var e;r=NUM(r);n=NUM(n);if(isNaN(r)){return NaN}if(isNaN(n)){return NaN}if(n===0){return NaN}e=Math.abs(r%n);if(n>0){return e}else{return-e}};e.MONTH=function(r){r=DATEVALUE(r);if(r==null){return NO_VALUE}return r.getMonth()+1};e.N=function(r){if(f.isNumber(r)){return r}if(r===true){return 1}if(r===false){return 0}return 0};e.NOT=function(r){return!(r!=null?r:false)};e.NUM=function(r){if(isNaN(r)){return NaN}return parseFloat(r)};e.NUMS=function(){return N(arguments).map(NUM)};e.ODD=function(r){var n;r=NUM(r);if(!f.isNumber(r)){return NaN}n=Math.ceil(Math.abs(r));n=n&1?n:n+1;if(r>=0){return n}else{return-n}};e.ONCE=function(r){var n;return(n=$$runtime.$$currentValue)!=null?n:r};e.OR=function(){return f.find(N(arguments),function(r){return r})!==void 0};e.OTHER=function(r){if(!HASOTHER(r)){return NO_VALUE}if(ISBLANK(r.other_values)){return NO_VALUE}return r.other_values[0]};e.PI=function(){return Math.PI};e.PLATFORM=function(){var r;return(r=i.platform)!=null?r:""};e.PLATFORMINFO=function(r){if(r==null){r=", "}return f.compact([PLATFORM(),PLATFORMVERSION()]).join(r)};e.PLATFORMVERSION=function(){var r;return(r=i.platformVersion)!=null?r:""};e.POWER=function(r,n){r=NUM(r);n=NUM(n);if(isNaN(r)){return NaN}if(isNaN(n)){return NaN}return Math.pow(r,n)};e.PRECISION=function(r){var n;r=NUM(r);if(ISNAN(r)){return NaN}n=(r+"").split(".");if(n.length<2){return 0}return n[1].length};e.PRODUCT=function(){var r,n;n=N(arguments).map(NUM);if(n.length===0){return NaN}r=f.some(n,isNaN);if(r){return NaN}return f.inject(n,function(r,n){return r*=n},1)};e.PROPER=function(r){if(r==null){return NO_VALUE}if(f.isArray(r)){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}return f.titleize(r.toString())};e.QUOTIENT=function(r,n){r=NUM(r);n=NUM(n);if(isNaN(r)){return NaN}if(isNaN(n)){return NaN}if(n===0){return NaN}return parseInt(r/n,10)};e.RADIANS=function(r){r=NUM(r);return r/180*Math.PI};e.RAND=function(){return Math.random()};e.RANDBETWEEN=function(r,n){r=NUM(r);n=NUM(n);if(isNaN(r)){return NaN}if(isNaN(n)){return NaN}return r+Math.ceil((n-r+1)*Math.random())-1};e.RECORDID=function(){var r;return(r=CONFIG().recordID)!=null?r:NO_VALUE};e.REPEATABLEID=function(){var r;return(r=CONFIG().featureID)!=null?r:NO_VALUE};e.REPEATABLENUMBER=function(){if(CONFIG().featureIndex==null){return NO_VALUE}return CONFIG().featureIndex+1};e.REPEATABLEVALUES=function(r,n){var e,t;e=$$runtime.elementsByDataName[n];if(!e){return NO_VALUE}t=l.nearestRepeatable(e);if(!t){return NO_VALUE}return l.repeatableValues(t,r,n)};e.REPEATABLESUM=function(r,n){return SUM.apply(null,f.reject(REPEATABLEVALUES(r,n),isNaN))};e.REPLACE=function(r,n,e,t){var i,u;n=FLOOR(n);e=FLOOR(e);if(r==null){return NO_VALUE}if(arguments.length<4){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}if(n<1){return NO_VALUE}if(isNaN(n)){return NO_VALUE}if(e<0){return NO_VALUE}if(isNaN(e)){return NO_VALUE}r=r.toString();i=r.substr(0,n-1);u=r.substr(n-1+e);return i+t+u};e.RESETCONFIG=function(){return i=f.extend({},u)};e.RIGHT=function(r,n){if(n==null){n=1}n=FLOOR(n);if(r==null){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}if(n<0){return NO_VALUE}if(isNaN(n)){return NO_VALUE}r=r.toString();return r.substring(r.length-n)};e.ROLE=function(){var r;return(r=CONFIG().userRoleName)!=null?r:NO_VALUE};e.ROUND=function(r,n){if(n==null){n=0}r=NUM(r);n=NUM(n);return Math.round(r*Math.pow(10,n))/Math.pow(10,n)};e.ROUNDDOWN=function(r,n){var e;if(n==null){n=0}r=NUM(r);n=NUM(n);e=r>0?1:-1;return e*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)};e.ROUNDUP=function(r,n){var e;if(n==null){n=0}r=NUM(r);n=NUM(n);e=r>0?1:-1;return e*Math.ceil(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)};e.SEARCH=function(r,n,e){var t;if(e==null){e=1}e=NUM(e);if(isNaN(e)){e=1}if(f.isNumber(n)){n=n.toString()}if(f.isNumber(r)){r=r.toString()}if(!f.isString(r)){return NO_VALUE}if(!f.isString(n)){return NO_VALUE}if(r===""){return 1}t=n.toLowerCase().indexOf(r.toLowerCase(),e-1);if(t<0){return NO_VALUE}return t+1};e.SETRESULT=function(r){return $$runtime.$$result=r};e.SHOWERRORS=function(r){if(r==null){r=true}return $$runtime.showErrors=r};e.SIGN=function(r){r=NUM(r);if(isNaN(r)){return NaN}switch(true){case r>0:return 1;case r<0:return-1;case r===0:return 0}};e.SIN=o(Math.sin);e.SINH=function(r){var n;r=NUM(r);n=Math.exp(r);return(n-1/n)/2};e.SQRT=o(Math.sqrt);e.SQRTPI=function(r){return SQRT(NUM(r)*Math.PI)};e.STATUS=function(){var r;return(r=CONFIG().recordStatus)!=null?r:NO_VALUE};e.STATUSLABEL=function(){var r,n,e;e=(r=CONFIG().recordStatus)!=null?r:NO_VALUE;if(e){return(n=$$runtime.statusesByValue[e])!=null?n:NO_VALUE}else{return NO_VALUE}};e.SUBSTITUTE=function(r,n,e,t){var i,u,a,o,l;t=FLOOR(t);if(arguments.length<3){return NO_VALUE}if(t<0){return NO_VALUE}a=!r||!f.isString(n)||!f.isString(e);if(a){return NO_VALUE}if(f.isArray(r)){return r}if(r.indexOf(n)<0){return r}r=r.toString();n=n.toString();e=e.toString();if(isNaN(t)){return r.replace(new RegExp(n,"g"),e)}else{u=r.indexOf(n,u);i=1;while(u>=0){if(i===t){o=r.substring(0,u);l=r.substring(u+n.length);return o+e+l}u=r.indexOf(n,u+1);i++}return r}};e.SUM=function(){var r,n;n=N(arguments).map(NUM);if(n.length===0){return NaN}r=f.some(n,isNaN);if(r){return NaN}return f.inject(n,function(r,n){return r+=n},0)};e.SUMSQ=function(){var r,n;n=N(arguments).map(NUM);if(n.length===0){return NaN}r=f.some(n,isNaN);if(r){return NaN}return f.inject(n,function(r,n){return r+=n*n},0)};e.T=function(r){if(r==null){return""}return r.toString()};e.TIMEDIFF=function(r,n,e){var t,i,u,a,o,l,s,c,p;if(e==null){e="hours"}if(!(f.isString(r)&&f.isString(n))){return NO_VALUE}if(!f.contains(["hours","minutes"],e)){return NO_VALUE}if(r.length!==5){return NO_VALUE}if(r[2]!==":"){return NO_VALUE}if(n.length!==5){return NO_VALUE}if(n[2]!==":"){return NO_VALUE}s=r.split(":");c=n.split(":");t=NUM(s[0]);i=NUM(s[1]);a=NUM(c[0]);o=NUM(c[1]);if(t>23||t<0){return NO_VALUE}if(a>23||a<0){return NO_VALUE}if(i>59||i<0){return NO_VALUE}if(o>59||o<0){return NO_VALUE}u=t*60+i;l=a*60+o;p=l-u;p=p===0?1440:p>0?p:1440+p;if(e==="hours"){return p/60}else{return p}};e.TIMEZONE=function(){return i.timeZone||u.timeZone};e.TRIM=function(r){return f.trim(r)};e.TRUE=function(r){return true};e.TYPEOF=function(r){switch(true){case f.isUndefined(r):return"undefined";case f.isNull(r):return"null";case f.isNaN(r):return"nan";case f.isNumber(r):return"number";case f.isString(r):return"string";case f.isBoolean(r):return"boolean";case f.isDate(r):return"date";case f.isArray(r):return"array";case f.isRegExp(r):return"regexp";case f.isFunction(r):return"function";case f.isObject(r):return"object";default:return"unknown"}};e.UPPER=function(r){if(r==null){return NO_VALUE}if(f.isArray(r)){return NO_VALUE}if(f.isObject(r)){return NO_VALUE}return r.toString().toUpperCase()};e.USERFULLNAME=function(){var r;return(r=CONFIG().userFullName)!=null?r:NO_VALUE};e.VERSIONINFO=function(r){if(r==null){r=", "}return f.compact([DEVICEINFO(" "),PLATFORMINFO(" "),APPLICATIONINFO(" ")]).join(r)};e.YEAR=function(r){r=DATEVALUE(r);if(r==null){return NO_VALUE}return r.getFullYear()};e.X_ISNEW=function(){return CONFIG().featureIsNew===true};e.X_ISUPDATE=function(){return!X_ISNEW()};p=function(r){return f.isFunction($$runtime["$$"+r])};c=function(r,n){return $$runtime["$$"+r].apply($$runtime,n)};a=s={};s.formatNumber=function(r,n,e){var t;if(p("formatNumber")){return c("formatNumber",arguments)}else if(typeof Intl!=="undefined"){t=new Intl.NumberFormat(n,e);return t.format(r)}else{return""+r}};n.exports=e},{"./utils":6,"object-inspect":2,underscore:4,"underscore.string":3}],2:[function(r,n,e){n.exports=function g(r,n,e,f){if(!n)n={};var c=n.depth===undefined?5:n.depth;if(e===undefined)e=0;if(e>=c&&c>0&&r&&typeof r==="object"){return"[Object]"}if(f===undefined)f=[];else if(m(f,r)>=0){return"[Circular]"}function v(r,t){if(t){f=f.slice();f.push(t)}return g(r,n,e+1,f)}if(typeof r==="string"){return h(r)}else if(typeof r==="function"){var E=p(r);return"[Function"+(E?": "+E:"")+"]"}else if(r===null){return"null"}else if(l(r)){var d=Symbol.prototype.toString.call(r);return typeof r==="object"?"Object("+d+")":d}else if(N(r)){var y="<"+String(r.nodeName).toLowerCase();var A=r.attributes||[];for(var O=0;O<A.length;O++){y+=" "+A[O].name+'="'+t(A[O].value)+'"'}y+=">";if(r.childNodes&&r.childNodes.length)y+="...";y+="</"+String(r.nodeName).toLowerCase()+">";return y}else if(i(r)){if(r.length===0)return"[]";var U=Array(r.length);for(var O=0;O<r.length;O++){U[O]=s(r,O)?v(r[O],r):""}return"[ "+U.join(", ")+" ]"}else if(o(r)){var M=[];for(var _ in r){if(!s(r,_))continue;if(/[^\w$]/.test(_)){M.push(v(_)+": "+v(r[_]))}else{M.push(_+": "+v(r[_]))}}if(M.length===0)return"["+r+"]";return"{ ["+r+"] "+M.join(", ")+" }"}else if(typeof r==="object"&&typeof r.inspect==="function"){return r.inspect()}else if(typeof r==="object"&&!u(r)&&!a(r)){var U=[],b=[];for(var _ in r){if(s(r,_))b.push(_)}b.sort();for(var O=0;O<b.length;O++){var _=b[O];if(/[^\w$]/.test(_)){U.push(v(_)+": "+v(r[_],r))}else U.push(_+": "+v(r[_],r))}if(U.length===0)return"{}";return"{ "+U.join(", ")+" }"}else return String(r)};function t(r){return String(r).replace(/"/g,"&quot;")}function i(r){return c(r)==="[object Array]"}function u(r){return c(r)==="[object Date]"}function a(r){return c(r)==="[object RegExp]"}function o(r){return c(r)==="[object Error]"}function l(r){return c(r)==="[object Symbol]"}var f=Object.prototype.hasOwnProperty||function(r){return r in this};function s(r,n){return f.call(r,n)}function c(r){return Object.prototype.toString.call(r)}function p(r){if(r.name)return r.name;var n=r.toString().match(/^function\s*([\w$]+)/);if(n)return n[1]}function m(r,n){if(r.indexOf)return r.indexOf(n);for(var e=0,t=r.length;e<t;e++){if(r[e]===n)return e}return-1}function N(r){if(!r||typeof r!=="object")return false;if(typeof HTMLElement!=="undefined"&&r instanceof HTMLElement){return true}return typeof r.nodeName==="string"&&typeof r.getAttribute==="function"}function h(r){var n=r.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,e);return"'"+n+"'";function e(r){var n=r.charCodeAt(0);var e={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];if(e)return"\\"+e;return"\\x"+(n<16?"0":"")+n.toString(16)}}},{}],3:[function(r,n,e){!function(r,t){"use strict";var i=t.prototype.trim;var u=t.prototype.trimRight;var a=t.prototype.trimLeft;var o=function(r){return r*1||0};var l=function(r,n){if(n<1)return"";var e="";while(n>0){if(n&1)e+=r;n>>=1,r+=r}return e};var f=[].slice;var s=function(r){if(r==null)return"\\s";else if(r.source)return r.source;else return"["+g.escapeRegExp(r)+"]"};function c(r,n){var e,t,i=r.toLowerCase();n=[].concat(n);for(e=0;e<n.length;e+=1){t=n[e];if(!t)continue;if(t.test&&t.test(r))return true;if(t.toLowerCase()===i)return true}}var p={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"};var m={};for(var N in p)m[p[N]]=N;m["'"]="#39";var h=function(){function r(r){return Object.prototype.toString.call(r).slice(8,-1).toLowerCase()}var n=l;var e=function(){if(!e.cache.hasOwnProperty(arguments[0])){e.cache[arguments[0]]=e.parse(arguments[0])}return e.format.call(null,e.cache[arguments[0]],arguments)};e.format=function(e,i){var u=1,a=e.length,o="",l,f=[],s,c,p,m,N,g;for(s=0;s<a;s++){o=r(e[s]);if(o==="string"){f.push(e[s])}else if(o==="array"){p=e[s];if(p[2]){l=i[u];for(c=0;c<p[2].length;c++){if(!l.hasOwnProperty(p[2][c])){throw new Error(h('[_.sprintf] property "%s" does not exist',p[2][c]))}l=l[p[2][c]]}}else if(p[1]){l=i[p[1]]}else{l=i[u++]}if(/[^s]/.test(p[8])&&r(l)!="number"){throw new Error(h("[_.sprintf] expecting number but found %s",r(l)))}switch(p[8]){case"b":l=l.toString(2);break;case"c":l=t.fromCharCode(l);break;case"d":l=parseInt(l,10);break;case"e":l=p[7]?l.toExponential(p[7]):l.toExponential();break;case"f":l=p[7]?parseFloat(l).toFixed(p[7]):parseFloat(l);break;case"o":l=l.toString(8);break;case"s":l=(l=t(l))&&p[7]?l.substring(0,p[7]):l;break;case"u":l=Math.abs(l);break;case"x":l=l.toString(16);break;case"X":l=l.toString(16).toUpperCase();break}l=/[def]/.test(p[8])&&p[3]&&l>=0?"+"+l:l;N=p[4]?p[4]=="0"?"0":p[4].charAt(1):" ";g=p[6]-t(l).length;m=p[6]?n(N,g):"";f.push(p[5]?l+m:m+l)}}return f.join("")};e.cache={};e.parse=function(r){var n=r,e=[],t=[],i=0;while(n){if((e=/^[^\x25]+/.exec(n))!==null){t.push(e[0])}else if((e=/^\x25{2}/.exec(n))!==null){t.push("%")}else if((e=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n))!==null){if(e[2]){i|=1;var u=[],a=e[2],o=[];if((o=/^([a-z_][a-z_\d]*)/i.exec(a))!==null){u.push(o[1]);while((a=a.substring(o[0].length))!==""){if((o=/^\.([a-z_][a-z_\d]*)/i.exec(a))!==null){u.push(o[1])}else if((o=/^\[(\d+)\]/.exec(a))!==null){u.push(o[1])}else{throw new Error("[_.sprintf] huh?")}}}else{throw new Error("[_.sprintf] huh?")}e[2]=u}else{i|=2}if(i===3){throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported")}t.push(e)}else{throw new Error("[_.sprintf] huh?")}n=n.substring(e[0].length)}return t};return e}();var g={VERSION:"2.4.0",isBlank:function(r){if(r==null)r="";return/^\s*$/.test(r)},stripTags:function(r){if(r==null)return"";return t(r).replace(/<\/?[^>]+>/g,"")},capitalize:function(r){r=r==null?"":t(r);return r.charAt(0).toUpperCase()+r.slice(1)},chop:function(r,n){if(r==null)return[];r=t(r);n=~~n;return n>0?r.match(new RegExp(".{1,"+n+"}","g")):[r]},clean:function(r){return g.strip(r).replace(/\s+/g," ")},count:function(r,n){if(r==null||n==null)return 0;r=t(r);n=t(n);var e=0,i=0,u=n.length;while(true){i=r.indexOf(n,i);if(i===-1)break;e++;i+=u}return e},chars:function(r){if(r==null)return[];return t(r).split("")},swapCase:function(r){if(r==null)return"";return t(r).replace(/\S/g,function(r){return r===r.toUpperCase()?r.toLowerCase():r.toUpperCase()})},escapeHTML:function(r){if(r==null)return"";return t(r).replace(/[&<>"']/g,function(r){return"&"+m[r]+";"})},unescapeHTML:function(r){if(r==null)return"";return t(r).replace(/\&([^;]+);/g,function(r,n){var e;if(n in p){return p[n]}else if(e=n.match(/^#x([\da-fA-F]+)$/)){return t.fromCharCode(parseInt(e[1],16))}else if(e=n.match(/^#(\d+)$/)){return t.fromCharCode(~~e[1])}else{return r}})},escapeRegExp:function(r){if(r==null)return"";return t(r).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(r,n,e,t){var i=g.chars(r);i.splice(~~n,~~e,t);return i.join("")},insert:function(r,n,e){return g.splice(r,n,0,e)},include:function(r,n){if(n==="")return true;if(r==null)return false;return t(r).indexOf(n)!==-1},join:function(){var r=f.call(arguments),n=r.shift();if(n==null)n="";return r.join(n)},lines:function(r){if(r==null)return[];return t(r).split("\n")},reverse:function(r){return g.chars(r).reverse().join("")},startsWith:function(r,n){if(n==="")return true;if(r==null||n==null)return false;r=t(r);n=t(n);return r.length>=n.length&&r.slice(0,n.length)===n},endsWith:function(r,n){if(n==="")return true;if(r==null||n==null)return false;r=t(r);n=t(n);return r.length>=n.length&&r.slice(r.length-n.length)===n},succ:function(r){if(r==null)return"";r=t(r);return r.slice(0,-1)+t.fromCharCode(r.charCodeAt(r.length-1)+1)},titleize:function(r){if(r==null)return"";r=t(r).toLowerCase();return r.replace(/(?:^|\s|-)\S/g,function(r){return r.toUpperCase()})},camelize:function(r){return g.trim(r).replace(/[-_\s]+(.)?/g,function(r,n){return n?n.toUpperCase():""})},underscored:function(r){return g.trim(r).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(r){return g.trim(r).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(r){return g.capitalize(g.camelize(t(r).replace(/[\W_]/g," ")).replace(/\s/g,""))},humanize:function(r){return g.capitalize(g.underscored(r).replace(/_id$/,"").replace(/_/g," "))},trim:function(r,n){if(r==null)return"";if(!n&&i)return i.call(r);n=s(n);return t(r).replace(new RegExp("^"+n+"+|"+n+"+$","g"),"")},ltrim:function(r,n){if(r==null)return"";if(!n&&a)return a.call(r);n=s(n);return t(r).replace(new RegExp("^"+n+"+"),"")},rtrim:function(r,n){if(r==null)return"";if(!n&&u)return u.call(r);n=s(n);return t(r).replace(new RegExp(n+"+$"),"")},truncate:function(r,n,e){if(r==null)return"";r=t(r);e=e||"...";n=~~n;return r.length>n?r.slice(0,n)+e:r},prune:function(r,n,e){if(r==null)return"";r=t(r);n=~~n;e=e!=null?t(e):"...";if(r.length<=n)return r;var i=function(r){return r.toUpperCase()!==r.toLowerCase()?"A":" "},u=r.slice(0,n+1).replace(/.(?=\W*\w*$)/g,i);if(u.slice(u.length-2).match(/\w\w/))u=u.replace(/\s*\S+$/,"");else u=g.rtrim(u.slice(0,u.length-1));return(u+e).length>r.length?r:r.slice(0,u.length)+e},words:function(r,n){if(g.isBlank(r))return[];return g.trim(r,n).split(n||/\s+/)},pad:function(r,n,e,i){r=r==null?"":t(r);n=~~n;var u=0;if(!e)e=" ";else if(e.length>1)e=e.charAt(0);switch(i){case"right":u=n-r.length;return r+l(e,u);case"both":u=n-r.length;return l(e,Math.ceil(u/2))+r+l(e,Math.floor(u/2));default:u=n-r.length;return l(e,u)+r}},lpad:function(r,n,e){return g.pad(r,n,e)},rpad:function(r,n,e){return g.pad(r,n,e,"right")},lrpad:function(r,n,e){return g.pad(r,n,e,"both")},sprintf:h,vsprintf:function(r,n){n.unshift(r);return h.apply(null,n)},toNumber:function(r,n){if(!r)return 0;r=g.trim(r);if(!r.match(/^-?\d+(?:\.\d+)?$/))return NaN;return o(o(r).toFixed(~~n))},numberFormat:function(r,n,e,t){if(isNaN(r)||r==null)return"";r=r.toFixed(~~n);t=typeof t=="string"?t:",";var i=r.split("."),u=i[0],a=i[1]?(e||".")+i[1]:"";return u.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+t)+a},strRight:function(r,n){if(r==null)return"";r=t(r);n=n!=null?t(n):n;var e=!n?-1:r.indexOf(n);return~e?r.slice(e+n.length,r.length):r},strRightBack:function(r,n){if(r==null)return"";r=t(r);n=n!=null?t(n):n;var e=!n?-1:r.lastIndexOf(n);return~e?r.slice(e+n.length,r.length):r},strLeft:function(r,n){if(r==null)return"";r=t(r);n=n!=null?t(n):n;var e=!n?-1:r.indexOf(n);return~e?r.slice(0,e):r},strLeftBack:function(r,n){if(r==null)return"";r+="";n=n!=null?""+n:n;var e=r.lastIndexOf(n);return~e?r.slice(0,e):r},toSentence:function(r,n,e,t){n=n||", ";e=e||" and ";var i=r.slice(),u=i.pop();if(r.length>2&&t)e=g.rtrim(n)+e;return i.length?i.join(n)+e+u:u},toSentenceSerial:function(){var r=f.call(arguments);r[3]=true;return g.toSentence.apply(g,r)},slugify:function(r){if(r==null)return"";var n="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",e="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",i=new RegExp(s(n),"g");r=t(r).toLowerCase().replace(i,function(r){var t=n.indexOf(r);return e.charAt(t)||"-"});return g.dasherize(r.replace(/[^\w\s-]/g,""))},surround:function(r,n){return[n,r,n].join("")},quote:function(r,n){return g.surround(r,n||'"')},unquote:function(r,n){n=n||'"';if(r[0]===n&&r[r.length-1]===n)return r.slice(1,r.length-1);else return r},exports:function(){var r={};for(var n in this){if(!this.hasOwnProperty(n)||n.match(/^(?:include|contains|reverse)$/))continue;r[n]=this[n]}return r},repeat:function(r,n,e){
if(r==null)return"";n=~~n;if(e==null)return l(t(r),n);for(var i=[];n>0;i[--n]=r){}return i.join(e)},naturalCmp:function(r,n){if(r==n)return 0;if(!r)return-1;if(!n)return 1;var e=/(\.\d+)|(\d+)|(\D+)/g,i=t(r).toLowerCase().match(e),u=t(n).toLowerCase().match(e),a=Math.min(i.length,u.length);for(var o=0;o<a;o++){var l=i[o],f=u[o];if(l!==f){var s=parseInt(l,10);if(!isNaN(s)){var c=parseInt(f,10);if(!isNaN(c)&&s-c)return s-c}return l<f?-1:1}}if(i.length===u.length)return i.length-u.length;return r<n?-1:1},levenshtein:function(r,n){if(r==null&&n==null)return 0;if(r==null)return t(n).length;if(n==null)return t(r).length;r=t(r);n=t(n);var e=[],i,u;for(var a=0;a<=n.length;a++)for(var o=0;o<=r.length;o++){if(a&&o)if(r.charAt(o-1)===n.charAt(a-1))u=i;else u=Math.min(e[o],e[o-1],i)+1;else u=a+o;i=e[o];e[o]=u}return e.pop()},toBoolean:function(r,n,e){if(typeof r==="number")r=""+r;if(typeof r!=="string")return!!r;r=g.trim(r);if(c(r,n||["true","1"]))return true;if(c(r,e||["false","0"]))return false}};g.strip=g.trim;g.lstrip=g.ltrim;g.rstrip=g.rtrim;g.center=g.lrpad;g.rjust=g.lpad;g.ljust=g.rpad;g.contains=g.include;g.q=g.quote;g.toBool=g.toBoolean;if(typeof e!=="undefined"){if(typeof n!=="undefined"&&n.exports)n.exports=g;e._s=g}if(typeof define==="function"&&define.amd)define("underscore.string",[],function(){return g});r._=r._||{};r._.string=r._.str=g}(this,String)},{}],4:[function(r,n,e){(function(){var r=this;var t=r._;var i=Array.prototype,u=Object.prototype,a=Function.prototype;var o=i.push,l=i.slice,f=u.toString,s=u.hasOwnProperty;var c=Array.isArray,p=Object.keys,m=a.bind,N=Object.create;var h=function(){};var g=function(r){if(r instanceof g)return r;if(!(this instanceof g))return new g(r);this._wrapped=r};if(typeof e!=="undefined"){if(typeof n!=="undefined"&&n.exports){e=n.exports=g}e._=g}else{r._=g}g.VERSION="1.8.3";var v=function(r,n,e){if(n===void 0)return r;switch(e==null?3:e){case 1:return function(e){return r.call(n,e)};case 2:return function(e,t){return r.call(n,e,t)};case 3:return function(e,t,i){return r.call(n,e,t,i)};case 4:return function(e,t,i,u){return r.call(n,e,t,i,u)}}return function(){return r.apply(n,arguments)}};var E=function(r,n,e){if(r==null)return g.identity;if(g.isFunction(r))return v(r,n,e);if(g.isObject(r))return g.matcher(r);return g.property(r)};g.iteratee=function(r,n){return E(r,n,Infinity)};var d=function(r,n){return function(e){var t=arguments.length;if(t<2||e==null)return e;for(var i=1;i<t;i++){var u=arguments[i],a=r(u),o=a.length;for(var l=0;l<o;l++){var f=a[l];if(!n||e[f]===void 0)e[f]=u[f]}}return e}};var y=function(r){if(!g.isObject(r))return{};if(N)return N(r);h.prototype=r;var n=new h;h.prototype=null;return n};var A=function(r){return function(n){return n==null?void 0:n[r]}};var O=Math.pow(2,53)-1;var U=A("length");var M=function(r){var n=U(r);return typeof n=="number"&&n>=0&&n<=O};g.each=g.forEach=function(r,n,e){n=v(n,e);var t,i;if(M(r)){for(t=0,i=r.length;t<i;t++){n(r[t],t,r)}}else{var u=g.keys(r);for(t=0,i=u.length;t<i;t++){n(r[u[t]],u[t],r)}}return r};g.map=g.collect=function(r,n,e){n=E(n,e);var t=!M(r)&&g.keys(r),i=(t||r).length,u=Array(i);for(var a=0;a<i;a++){var o=t?t[a]:a;u[a]=n(r[o],o,r)}return u};function _(r){function n(n,e,t,i,u,a){for(;u>=0&&u<a;u+=r){var o=i?i[u]:u;t=e(t,n[o],o,n)}return t}return function(e,t,i,u){t=v(t,u,4);var a=!M(e)&&g.keys(e),o=(a||e).length,l=r>0?0:o-1;if(arguments.length<3){i=e[a?a[l]:l];l+=r}return n(e,t,i,a,l,o)}}g.reduce=g.foldl=g.inject=_(1);g.reduceRight=g.foldr=_(-1);g.find=g.detect=function(r,n,e){var t;if(M(r)){t=g.findIndex(r,n,e)}else{t=g.findKey(r,n,e)}if(t!==void 0&&t!==-1)return r[t]};g.filter=g.select=function(r,n,e){var t=[];n=E(n,e);g.each(r,function(r,e,i){if(n(r,e,i))t.push(r)});return t};g.reject=function(r,n,e){return g.filter(r,g.negate(E(n)),e)};g.every=g.all=function(r,n,e){n=E(n,e);var t=!M(r)&&g.keys(r),i=(t||r).length;for(var u=0;u<i;u++){var a=t?t[u]:u;if(!n(r[a],a,r))return false}return true};g.some=g.any=function(r,n,e){n=E(n,e);var t=!M(r)&&g.keys(r),i=(t||r).length;for(var u=0;u<i;u++){var a=t?t[u]:u;if(n(r[a],a,r))return true}return false};g.contains=g.includes=g.include=function(r,n,e,t){if(!M(r))r=g.values(r);if(typeof e!="number"||t)e=0;return g.indexOf(r,n,e)>=0};g.invoke=function(r,n){var e=l.call(arguments,2);var t=g.isFunction(n);return g.map(r,function(r){var i=t?n:r[n];return i==null?i:i.apply(r,e)})};g.pluck=function(r,n){return g.map(r,g.property(n))};g.where=function(r,n){return g.filter(r,g.matcher(n))};g.findWhere=function(r,n){return g.find(r,g.matcher(n))};g.max=function(r,n,e){var t=-Infinity,i=-Infinity,u,a;if(n==null&&r!=null){r=M(r)?r:g.values(r);for(var o=0,l=r.length;o<l;o++){u=r[o];if(u>t){t=u}}}else{n=E(n,e);g.each(r,function(r,e,u){a=n(r,e,u);if(a>i||a===-Infinity&&t===-Infinity){t=r;i=a}})}return t};g.min=function(r,n,e){var t=Infinity,i=Infinity,u,a;if(n==null&&r!=null){r=M(r)?r:g.values(r);for(var o=0,l=r.length;o<l;o++){u=r[o];if(u<t){t=u}}}else{n=E(n,e);g.each(r,function(r,e,u){a=n(r,e,u);if(a<i||a===Infinity&&t===Infinity){t=r;i=a}})}return t};g.shuffle=function(r){var n=M(r)?r:g.values(r);var e=n.length;var t=Array(e);for(var i=0,u;i<e;i++){u=g.random(0,i);if(u!==i)t[i]=t[u];t[u]=n[i]}return t};g.sample=function(r,n,e){if(n==null||e){if(!M(r))r=g.values(r);return r[g.random(r.length-1)]}return g.shuffle(r).slice(0,Math.max(0,n))};g.sortBy=function(r,n,e){n=E(n,e);return g.pluck(g.map(r,function(r,e,t){return{value:r,index:e,criteria:n(r,e,t)}}).sort(function(r,n){var e=r.criteria;var t=n.criteria;if(e!==t){if(e>t||e===void 0)return 1;if(e<t||t===void 0)return-1}return r.index-n.index}),"value")};var b=function(r){return function(n,e,t){var i={};e=E(e,t);g.each(n,function(t,u){var a=e(t,u,n);r(i,t,a)});return i}};g.groupBy=b(function(r,n,e){if(g.has(r,e))r[e].push(n);else r[e]=[n]});g.indexBy=b(function(r,n,e){r[e]=n});g.countBy=b(function(r,n,e){if(g.has(r,e))r[e]++;else r[e]=1});g.toArray=function(r){if(!r)return[];if(g.isArray(r))return l.call(r);if(M(r))return g.map(r,g.identity);return g.values(r)};g.size=function(r){if(r==null)return 0;return M(r)?r.length:g.keys(r).length};g.partition=function(r,n,e){n=E(n,e);var t=[],i=[];g.each(r,function(r,e,u){(n(r,e,u)?t:i).push(r)});return[t,i]};g.first=g.head=g.take=function(r,n,e){if(r==null)return void 0;if(n==null||e)return r[0];return g.initial(r,r.length-n)};g.initial=function(r,n,e){return l.call(r,0,Math.max(0,r.length-(n==null||e?1:n)))};g.last=function(r,n,e){if(r==null)return void 0;if(n==null||e)return r[r.length-1];return g.rest(r,Math.max(0,r.length-n))};g.rest=g.tail=g.drop=function(r,n,e){return l.call(r,n==null||e?1:n)};g.compact=function(r){return g.filter(r,g.identity)};var L=function(r,n,e,t){var i=[],u=0;for(var a=t||0,o=U(r);a<o;a++){var l=r[a];if(M(l)&&(g.isArray(l)||g.isArguments(l))){if(!n)l=L(l,n,e);var f=0,s=l.length;i.length+=s;while(f<s){i[u++]=l[f++]}}else if(!e){i[u++]=l}}return i};g.flatten=function(r,n){return L(r,n,false)};g.without=function(r){return g.difference(r,l.call(arguments,1))};g.uniq=g.unique=function(r,n,e,t){if(!g.isBoolean(n)){t=e;e=n;n=false}if(e!=null)e=E(e,t);var i=[];var u=[];for(var a=0,o=U(r);a<o;a++){var l=r[a],f=e?e(l,a,r):l;if(n){if(!a||u!==f)i.push(l);u=f}else if(e){if(!g.contains(u,f)){u.push(f);i.push(l)}}else if(!g.contains(i,l)){i.push(l)}}return i};g.union=function(){return g.uniq(L(arguments,true,true))};g.intersection=function(r){var n=[];var e=arguments.length;for(var t=0,i=U(r);t<i;t++){var u=r[t];if(g.contains(n,u))continue;for(var a=1;a<e;a++){if(!g.contains(arguments[a],u))break}if(a===e)n.push(u)}return n};g.difference=function(r){var n=L(arguments,true,true,1);return g.filter(r,function(r){return!g.contains(n,r)})};g.zip=function(){return g.unzip(arguments)};g.unzip=function(r){var n=r&&g.max(r,U).length||0;var e=Array(n);for(var t=0;t<n;t++){e[t]=g.pluck(r,t)}return e};g.object=function(r,n){var e={};for(var t=0,i=U(r);t<i;t++){if(n){e[r[t]]=n[t]}else{e[r[t][0]]=r[t][1]}}return e};function S(r){return function(n,e,t){e=E(e,t);var i=U(n);var u=r>0?0:i-1;for(;u>=0&&u<i;u+=r){if(e(n[u],u,n))return u}return-1}}g.findIndex=S(1);g.findLastIndex=S(-1);g.sortedIndex=function(r,n,e,t){e=E(e,t,1);var i=e(n);var u=0,a=U(r);while(u<a){var o=Math.floor((u+a)/2);if(e(r[o])<i)u=o+1;else a=o}return u};function I(r,n,e){return function(t,i,u){var a=0,o=U(t);if(typeof u=="number"){if(r>0){a=u>=0?u:Math.max(u+o,a)}else{o=u>=0?Math.min(u+1,o):u+o+1}}else if(e&&u&&o){u=e(t,i);return t[u]===i?u:-1}if(i!==i){u=n(l.call(t,a,o),g.isNaN);return u>=0?u+a:-1}for(u=r>0?a:o-1;u>=0&&u<o;u+=r){if(t[u]===i)return u}return-1}}g.indexOf=I(1,g.findIndex,g.sortedIndex);g.lastIndexOf=I(-1,g.findLastIndex);g.range=function(r,n,e){if(n==null){n=r||0;r=0}e=e||1;var t=Math.max(Math.ceil((n-r)/e),0);var i=Array(t);for(var u=0;u<t;u++,r+=e){i[u]=r}return i};var R=function(r,n,e,t,i){if(!(t instanceof n))return r.apply(e,i);var u=y(r.prototype);var a=r.apply(u,i);if(g.isObject(a))return a;return u};g.bind=function(r,n){if(m&&r.bind===m)return m.apply(r,l.call(arguments,1));if(!g.isFunction(r))throw new TypeError("Bind must be called on a function");var e=l.call(arguments,2);var t=function(){return R(r,t,n,this,e.concat(l.call(arguments)))};return t};g.partial=function(r){var n=l.call(arguments,1);var e=function(){var t=0,i=n.length;var u=Array(i);for(var a=0;a<i;a++){u[a]=n[a]===g?arguments[t++]:n[a]}while(t<arguments.length)u.push(arguments[t++]);return R(r,e,this,this,u)};return e};g.bindAll=function(r){var n,e=arguments.length,t;if(e<=1)throw new Error("bindAll must be passed function names");for(n=1;n<e;n++){t=arguments[n];r[t]=g.bind(r[t],r)}return r};g.memoize=function(r,n){var e=function(t){var i=e.cache;var u=""+(n?n.apply(this,arguments):t);if(!g.has(i,u))i[u]=r.apply(this,arguments);return i[u]};e.cache={};return e};g.delay=function(r,n){var e=l.call(arguments,2);return setTimeout(function(){return r.apply(null,e)},n)};g.defer=g.partial(g.delay,g,1);g.throttle=function(r,n,e){var t,i,u;var a=null;var o=0;if(!e)e={};var l=function(){o=e.leading===false?0:g.now();a=null;u=r.apply(t,i);if(!a)t=i=null};return function(){var f=g.now();if(!o&&e.leading===false)o=f;var s=n-(f-o);t=this;i=arguments;if(s<=0||s>n){if(a){clearTimeout(a);a=null}o=f;u=r.apply(t,i);if(!a)t=i=null}else if(!a&&e.trailing!==false){a=setTimeout(l,s)}return u}};g.debounce=function(r,n,e){var t,i,u,a,o;var l=function(){var f=g.now()-a;if(f<n&&f>=0){t=setTimeout(l,n-f)}else{t=null;if(!e){o=r.apply(u,i);if(!t)u=i=null}}};return function(){u=this;i=arguments;a=g.now();var f=e&&!t;if(!t)t=setTimeout(l,n);if(f){o=r.apply(u,i);u=i=null}return o}};g.wrap=function(r,n){return g.partial(n,r)};g.negate=function(r){return function(){return!r.apply(this,arguments)}};g.compose=function(){var r=arguments;var n=r.length-1;return function(){var e=n;var t=r[n].apply(this,arguments);while(e--)t=r[e].call(this,t);return t}};g.after=function(r,n){return function(){if(--r<1){return n.apply(this,arguments)}}};g.before=function(r,n){var e;return function(){if(--r>0){e=n.apply(this,arguments)}if(r<=1)n=null;return e}};g.once=g.partial(g.before,2);var C=!{toString:null}.propertyIsEnumerable("toString");var V=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function x(r,n){var e=V.length;var t=r.constructor;var i=g.isFunction(t)&&t.prototype||u;var a="constructor";if(g.has(r,a)&&!g.contains(n,a))n.push(a);while(e--){a=V[e];if(a in r&&r[a]!==i[a]&&!g.contains(n,a)){n.push(a)}}}g.keys=function(r){if(!g.isObject(r))return[];if(p)return p(r);var n=[];for(var e in r)if(g.has(r,e))n.push(e);if(C)x(r,n);return n};g.allKeys=function(r){if(!g.isObject(r))return[];var n=[];for(var e in r)n.push(e);if(C)x(r,n);return n};g.values=function(r){var n=g.keys(r);var e=n.length;var t=Array(e);for(var i=0;i<e;i++){t[i]=r[n[i]]}return t};g.mapObject=function(r,n,e){n=E(n,e);var t=g.keys(r),i=t.length,u={},a;for(var o=0;o<i;o++){a=t[o];u[a]=n(r[a],a,r)}return u};g.pairs=function(r){var n=g.keys(r);var e=n.length;var t=Array(e);for(var i=0;i<e;i++){t[i]=[n[i],r[n[i]]]}return t};g.invert=function(r){var n={};var e=g.keys(r);for(var t=0,i=e.length;t<i;t++){n[r[e[t]]]=e[t]}return n};g.functions=g.methods=function(r){var n=[];for(var e in r){if(g.isFunction(r[e]))n.push(e)}return n.sort()};g.extend=d(g.allKeys);g.extendOwn=g.assign=d(g.keys);g.findKey=function(r,n,e){n=E(n,e);var t=g.keys(r),i;for(var u=0,a=t.length;u<a;u++){i=t[u];if(n(r[i],i,r))return i}};g.pick=function(r,n,e){var t={},i=r,u,a;if(i==null)return t;if(g.isFunction(n)){a=g.allKeys(i);u=v(n,e)}else{a=L(arguments,false,false,1);u=function(r,n,e){return n in e};i=Object(i)}for(var o=0,l=a.length;o<l;o++){var f=a[o];var s=i[f];if(u(s,f,i))t[f]=s}return t};g.omit=function(r,n,e){if(g.isFunction(n)){n=g.negate(n)}else{var t=g.map(L(arguments,false,false,1),String);n=function(r,n){return!g.contains(t,n)}}return g.pick(r,n,e)};g.defaults=d(g.allKeys,true);g.create=function(r,n){var e=y(r);if(n)g.extendOwn(e,n);return e};g.clone=function(r){if(!g.isObject(r))return r;return g.isArray(r)?r.slice():g.extend({},r)};g.tap=function(r,n){n(r);return r};g.isMatch=function(r,n){var e=g.keys(n),t=e.length;if(r==null)return!t;var i=Object(r);for(var u=0;u<t;u++){var a=e[u];if(n[a]!==i[a]||!(a in i))return false}return true};var D=function(r,n,e,t){if(r===n)return r!==0||1/r===1/n;if(r==null||n==null)return r===n;if(r instanceof g)r=r._wrapped;if(n instanceof g)n=n._wrapped;var i=f.call(r);if(i!==f.call(n))return false;switch(i){case"[object RegExp]":case"[object String]":return""+r===""+n;case"[object Number]":if(+r!==+r)return+n!==+n;return+r===0?1/+r===1/n:+r===+n;case"[object Date]":case"[object Boolean]":return+r===+n}var u=i==="[object Array]";if(!u){if(typeof r!="object"||typeof n!="object")return false;var a=r.constructor,o=n.constructor;if(a!==o&&!(g.isFunction(a)&&a instanceof a&&g.isFunction(o)&&o instanceof o)&&("constructor"in r&&"constructor"in n)){return false}}e=e||[];t=t||[];var l=e.length;while(l--){if(e[l]===r)return t[l]===n}e.push(r);t.push(n);if(u){l=r.length;if(l!==n.length)return false;while(l--){if(!D(r[l],n[l],e,t))return false}}else{var s=g.keys(r),c;l=s.length;if(g.keys(n).length!==l)return false;while(l--){c=s[l];if(!(g.has(n,c)&&D(r[c],n[c],e,t)))return false}}e.pop();t.pop();return true};g.isEqual=function(r,n){return D(r,n)};g.isEmpty=function(r){if(r==null)return true;if(M(r)&&(g.isArray(r)||g.isString(r)||g.isArguments(r)))return r.length===0;return g.keys(r).length===0};g.isElement=function(r){return!!(r&&r.nodeType===1)};g.isArray=c||function(r){return f.call(r)==="[object Array]"};g.isObject=function(r){var n=typeof r;return n==="function"||n==="object"&&!!r};g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(r){g["is"+r]=function(n){return f.call(n)==="[object "+r+"]"}});if(!g.isArguments(arguments)){g.isArguments=function(r){return g.has(r,"callee")}}if(typeof/./!="function"&&typeof Int8Array!="object"){g.isFunction=function(r){return typeof r=="function"||false}}g.isFinite=function(r){return isFinite(r)&&!isNaN(parseFloat(r))};g.isNaN=function(r){return g.isNumber(r)&&r!==+r};g.isBoolean=function(r){return r===true||r===false||f.call(r)==="[object Boolean]"};g.isNull=function(r){return r===null};g.isUndefined=function(r){return r===void 0};g.has=function(r,n){return r!=null&&s.call(r,n)};g.noConflict=function(){r._=t;return this};g.identity=function(r){return r};g.constant=function(r){return function(){return r}};g.noop=function(){};g.property=A;g.propertyOf=function(r){return r==null?function(){}:function(n){return r[n]}};g.matcher=g.matches=function(r){r=g.extendOwn({},r);return function(n){return g.isMatch(n,r)}};g.times=function(r,n,e){var t=Array(Math.max(0,r));n=v(n,e,1);for(var i=0;i<r;i++)t[i]=n(i);return t};g.random=function(r,n){if(n==null){n=r;r=0}return r+Math.floor(Math.random()*(n-r+1))};g.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var F=g.invert(w);var T=function(r){var n=function(n){return r[n]};var e="(?:"+g.keys(r).join("|")+")";var t=RegExp(e);var i=RegExp(e,"g");return function(r){r=r==null?"":""+r;return t.test(r)?r.replace(i,n):r}};g.escape=T(w);g.unescape=T(F);g.result=function(r,n,e){var t=r==null?void 0:r[n];if(t===void 0){t=e}return g.isFunction(t)?t.call(r):t};var j=0;g.uniqueId=function(r){var n=++j+"";return r?r+n:n};g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var $=/(.)^/;var P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var B=/\\|'|\r|\n|\u2028|\u2029/g;var G=function(r){return"\\"+P[r]};g.template=function(r,n,e){if(!n&&e)n=e;n=g.defaults({},n,g.templateSettings);var t=RegExp([(n.escape||$).source,(n.interpolate||$).source,(n.evaluate||$).source].join("|")+"|$","g");var i=0;var u="__p+='";r.replace(t,function(n,e,t,a,o){u+=r.slice(i,o).replace(B,G);i=o+n.length;if(e){u+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"}else if(t){u+="'+\n((__t=("+t+"))==null?'':__t)+\n'"}else if(a){u+="';\n"+a+"\n__p+='"}return n});u+="';\n";if(!n.variable)u="with(obj||{}){\n"+u+"}\n";u="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{var a=new Function(n.variable||"obj","_",u)}catch(o){o.source=u;throw o}var l=function(r){return a.call(this,r,g)};var f=n.variable||"obj";l.source="function("+f+"){\n"+u+"}";return l};g.chain=function(r){var n=g(r);n._chain=true;return n};var k=function(r,n){return r._chain?g(n).chain():n};g.mixin=function(r){g.each(g.functions(r),function(n){var e=g[n]=r[n];g.prototype[n]=function(){var r=[this._wrapped];o.apply(r,arguments);return k(this,e.apply(g,r))}})};g.mixin(g);g.each(["pop","push","reverse","shift","sort","splice","unshift"],function(r){var n=i[r];g.prototype[r]=function(){var e=this._wrapped;n.apply(e,arguments);if((r==="shift"||r==="splice")&&e.length===0)delete e[0];return k(this,e)}});g.each(["concat","join","slice"],function(r){var n=i[r];g.prototype[r]=function(){return k(this,n.apply(this._wrapped,arguments))}});g.prototype.value=function(){return this._wrapped};g.prototype.valueOf=g.prototype.toJSON=g.prototype.value;g.prototype.toString=function(){return""+this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return g})}}).call(this)},{}],5:[function(require,module,exports){var Runtime,Utils,_,functions;_=require("underscore");functions=require("./functions");Utils=require("./utils");Runtime=function(){function Runtime(){this.setupGlobal();this.setupFunctions()}Runtime.defaultLocale="en_US";Runtime.defaultCurrencyCode="USD";Runtime.defaultCurrencySymbol="$";Runtime.defaultTimeZone="UTC";Runtime.prototype.global=null;Runtime.prototype.expressions=[];Runtime.prototype.form={};Runtime.prototype.values={};Runtime.prototype.customVariables={};Runtime.prototype.locale=Runtime.defaultLocale;Runtime.prototype.currencyCode=Runtime.defaultCurrencyCode;Runtime.prototype.currencySymbol=Runtime.defaultCurrencySymbol;Runtime.prototype.variables={};Runtime.prototype.results=[];Runtime.prototype.dataNames={};Runtime.prototype.elements=[];Runtime.prototype.elementsByKey={};Runtime.prototype.elementsByDataName={};Runtime.prototype.statusesByValue={};Runtime.prototype.featureIsNew=true;Runtime.prototype.showErrors=false;Runtime.prototype.extraVariableNames=["locale","language","timeZone","decimalSeparator","groupingSeparator","currencySymbol","currencyCode","country","deviceIdentifier","deviceModel","deviceManufacturer","platform","platformVersion","application","applicationVersion","applicationBuild","userEmail","userRoleName","recordStatus","recordSystemCreatedAt","recordSystemUpdatedAt","recordClientCreatedAt","recordClientUpdatedAt","recordProject","recordProjectName","recordGeometry","recordAltitude","recordVerticalAccuracy","recordHorizontalAccuracy","featureCreatedAt","featureUpdatedAt","featureGeometry"];Runtime.prototype.setupValues=function(){var r,n,e,t,i,u,a,o,l;o=this.variables={};u=this.dataNames;for(e in u){o["$"+u[e]]=void 0}for(e in this.values){l=this.values[e];r=this.elementsByKey[e];if(r&&this.dataNames[e]){o["$"+this.dataNames[e]]=Utils.valueForElement(r,l)}}a=this.extraVariableNames;for(n=0,t=a.length;n<t;n++){i=a[n];o["$$"+i]=this[i]}for(i in this.customVariables){o[""+i]=this.customVariables[i]}return functions.CONFIGURE(this,false)};Runtime.prototype.prepare=function(){this.elements=Utils.flattenElements(this.form.elements,true,true);if(this.form.status_field&&this.form.status_field.choices){_.each(this.form.status_field.choices,function(r){return function(n){return r.statusesByValue[n.value]=n.label}}(this))}return _.each(this.elements,function(r){return function(n){r.elementsByKey[n.key]=n;r.elementsByDataName[n.data_name]=n;return r.dataNames[n.key]=n.data_name}}(this))};Runtime.prototype.evaluate=function(){this.setupValues();return this.results=_.map(this.expressions,function(r){return function(n){return r.evaluateExpression(n)}}(this))};Runtime.prototype.evaluateExpression=function(context){var error,evalResult,ex,rawValue,stringValue,thisVariableName,variables;variables=this.variables;thisVariableName="$"+context.dataName;try{$$runtime.showErrors=false;variables.$$current=$$runtime.$$currentValue=variables[thisVariableName];stringValue=rawValue=$$runtime.$$result=void 0;if(context.expression&&context.expression.length>0){evalResult=void 0;with(variables){evalResult=eval(context.expression)}rawValue=this.coalesce($$runtime.$$result,evalResult);stringValue=this.formatValue(rawValue);variables[thisVariableName]=_.isNumber(rawValue)||_.isDate(rawValue)?rawValue:stringValue}return this.createResult(context.key,rawValue,stringValue,null,$$runtime.showErrors)}catch(error){ex=error;console.log("JS ERROR : "+context.dataName+" : "+ex.toString());variables[thisVariableName]=void 0;return this.createResult(context.key,null,null,ex.toString(),$$runtime.showErrors)}};Runtime.prototype.coalesce=function(){return _.find(Utils.toArray(arguments),function(r){return!_.isUndefined(r)})};Runtime.prototype.createResult=function(r,n,e,t,i){if(i){if(t){t=t.toString()}else if(_.isUndefined(n)){t="[Undefined]"}else if(_.isNaN(n)){t="[Not a Number]"}else if(_.isFunction(n)){t="[Function]"}else if(_.isArray(n)){t="[Array]"}else if(_.isDate(n)){t=null}else if(_.isObject(n)){t="[Object]"}}else{t=null}return{key:r,value:e,error:t}};Runtime.prototype.formatValue=function(r){if(_.isUndefined(r)){r=null}else if(_.isNull(r)){r=null}else if(_.isNaN(r)){r=null}else if(_.isNumber(r)){r=r}else if(_.isDate(r)){r=Utils.formatMachineDate(r)}else if(_.isArray(r)){r=r.map(this.formatValue).join(", ")}else if(_.isRegExp(r)){r=r.toString()}else if(_.isFunction(r)){r=null}return r};Runtime.prototype.setupGlobal=function(){var r,n;this.global=void 0;try{this.global=Function("return this")()}catch(n){r=n;this.global=window}this.global.$$runtime=this;this.global.$$prepare=this.prepare.bind(this);return this.global.$$evaluate=this.evaluate.bind(this)};Runtime.prototype.setupFunctions=function(){var r,n;this.functions||(this.functions={});n=[];for(r in functions){n.push(this.global[r]=this.functions[r]=functions[r])}return n};return Runtime}();module.exports=new Runtime},{"./functions":1,"./utils":6,underscore:4}],6:[function(r,n,e){var t,i,u,a,o;i=r("underscore");o={};a={};u={};t=function(){function r(){}r.DATE_REGEX=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/;r.toArray=function(r){return Array.prototype.slice.call(r,0)};r.flattenElements=function(n,e,t,u){if(e==null){e=true}if(t==null){t=false}if(u==null){u=void 0}return i.tap([],function(a){return i.each(n,function(n){var i,o;if(t){n.parent=u}a.push(n);o=true;if(!e&&n.type==="Repeatable"){o=false}if(o&&n.elements){i=r.flattenElements(n.elements,e,t,n);return Array.prototype.push.apply(a,i)}})})};r.nearestRepeatable=function(r){var n;n=r;while(n){if(n.type==="Repeatable"){return n}n=n.parent}return null};r.valueForElement=function(n,e){if(r.isNumericElement(n)){return r.numberValue(e)}else if(r.isDateElement(n)){return r.dateValue(e)}else{return e}};r.isNumericElement=function(r){var n,e;return r.numeric||((n=r.display)!=null?n.style:void 0)==="number"||((e=r.display)!=null?e.style:void 0)==="currency"};r.isDateElement=function(r){return r.type==="DateTimeField"||r.type==="DateField"};r.dateValue=function(r){if(r&&r.length<=10){return new Date(r.replace(/-/g,"/")+" 00:00:00")}else{return r}};r.numberValue=function(r){r||(r=void 0);if(r!=null){return Number(r)}else{return void 0}};r.repeatableValueElements=function(n){var e,t,i,l,f,s,c,p,m;p=n.key;if(o[p]){l={all:o[p],byKey:a[p],byDataName:u[p]};return l}s=r.flattenElements(n.elements,false);o[p]=e=s;a[p]=i={};u[p]=t={};for(c=0,m=s.length;c<m;c++){f=s[c];i[f.key]=f;t[f.data_name]=f}return{all:e,byKey:i,byDataName:t}};r.repeatableValues=function(n,e,t){var u,a,o;if(!i.isArray(e)){return null}u=r.repeatableValueElements(n).byDataName;a=u[t];if(!a){return null}o=i.map(e,function(n){return r.valueForElement(a,n.form_values[a.key])});return o};r.formatMachineDate=function(r){if(!(r!=null&&!isNaN(r.getTime()))){return null}return RIGHT("000"+r.getFullYear(),4)+"-"+RIGHT("0"+(r.getMonth()+1),2)+"-"+RIGHT("0"+r.getDate(),2)};return r}();n.exports=t},{underscore:4}]},{},[5]);
